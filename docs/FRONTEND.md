# 前端与交互设计

## 技术栈
- React + Next.js（SSR 便于 SEO 与分享页首屏），或 Vite + React 单页；
- 状态管理：React Query + Zustand（或 Redux Toolkit）；
- UI：TailwindCSS + Headless UI；Icon：Lucide；
- PDF 渲染：pdf.js + 自定义 Canvas/图像渲染层；
- 设备适配：CSS Grid/Flex + viewport meta，使用 `@media` 与容器查询。

## 布局原则
- **响应式**：宽屏采用三栏（导航/内容/侧边信息），窄屏折叠侧栏并提供底部导航；
- **可触控**：按钮高度≥44px，手势翻页、双指缩放；
- **安全提示**：显式显示“禁止下载/打印/复制”徽章。

## 页面结构
### 1) 管理后台
- 登录/注册页：邮箱 + 验证码/密码；
- Dashboard：概览卡片（文档数、分享数、试读/浏览访问量、拦截次数）；
- 文档库：上传、搜索、分页表格；
- 分享配置抽屉：选择模式、页数限制或收件人信息、过期时间、水印文本预览；
- 分享记录：模式、状态、访问次数、复制链接按钮；
- 审计日志：时间轴/表格 + 筛选；
- 个人设置：密码修改、多因素开启、设备列表。

### 2) 阅读器（访客端）
- **访问引导**：
  - 浏览模式：邮件链接打开 -> 验证成功 -> 自动跳转阅读器。
  - 试读模式：直接进入阅读器，顶部提示“试读 N 页”。
- **阅读界面**：
  - 头部工具栏（桌面）：上一页/下一页、页码输入、缩放、全屏、主题切换。
  - 底部浮动工具栏（移动）：左右翻页、缩放、页数显示。
  - 水印层：`pointer-events:none`，Canvas 生成重复水印，内容含姓名/邮箱/提示字样。
  - 防护：隐藏浏览器默认下载按钮，拦截右键、`Cmd/Ctrl+P`、文本选择；检测 `print` 事件上报。
- **错误与限制提示**：未授权页显示遮罩与“需验证邮件后继续”按钮；试读到达上限提示 CTA 联系管理员。

## 组件规划
- `UploadCard`：上传 PDF，展示进度与校验错误；
- `ShareDrawer`：配置试读/浏览模式，生成链接；
- `WatermarkLayer`：基于 Canvas 生成重复图案，支持动态文字；
- `PdfViewport`：封装 pdf.js 渲染、分页、缩放、手势；
- `ReaderGuard`：根据模式校验 Token 与页码权限；
- `AuditReporter`：封装前端事件上报。

## 性能与体验
- 懒加载：按需加载 pdf.js、页面组件；
- 预取：阅读器提前获取下一页渲染；
- 占位骨架：加载页展示 skeleton；
- 深色模式与高对比度支持；
- PWA：离线缓存仅限认证后的安全资源白名单，禁止缓存原始 PDF。

## 可测试性
- 单元测试：组件层使用 Jest/React Testing Library；
- 端到端：Playwright 模拟桌面/移动视口，覆盖试读与浏览流程；
- 无障碍：使用 axe 进行 a11y 扫描；保证键盘可用。
